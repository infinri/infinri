<?php
/**
 * Messages Template
 * 
 * Displays flash messages (success, error, warning, info)
 * 
 * @var \Infinri\Core\Block\Template $block
 * @var \Infinri\Theme\ViewModel\Messages $messagesViewModel
 */

$messagesViewModel = $block->getData('view_model');

if (!$messagesViewModel || !$messagesViewModel->hasMessages()) {
    return;
}

$messages = $messagesViewModel->getMessages();
?>
<div class="messages" data-auto-hide="5000">
    <?php foreach ($messages as $message): ?>
        <?php
        $type = $message['type'] ?? 'info';
        $text = $message['text'] ?? '';
        $iconClass = $messagesViewModel->getIconClass($type);
        $ariaRole = $messagesViewModel->getAriaRole($type);
        ?>
        <div class="message message-<?= $block->escapeHtmlAttr($type) ?>" 
             role="<?= $block->escapeHtmlAttr($ariaRole) ?>"
             aria-live="polite"
             data-message-type="<?= $block->escapeHtmlAttr($type) ?>">
            <div class="message-content">
                <span class="message-icon <?= $block->escapeHtmlAttr($iconClass) ?>" aria-hidden="true"></span>
                <span class="message-text"><?= $block->escapeHtml($text) ?></span>
            </div>
            <button type="button" 
                    class="message-close" 
                    aria-label="<?= $block->escapeHtmlAttr('Close message') ?>"
                    data-dismiss="message">
                Ã—
            </button>
        </div>
    <?php endforeach; ?>
</div>
