<?php
/**
 * Admin Menu Template
 * 
 * @var \Infinri\Admin\Block\Menu $block
 */
error_log("Menu template rendering");
$menuItems = $block->getMenuItems();
error_log("Menu items in template: " . count($menuItems));
?>
<!-- MENU DEBUG: START -->
<nav class="admin-navigation">
    <ul class="admin-menu">
        <?php foreach ($menuItems as $item): ?>
            <li class="admin-menu-item <?= $block->isActive($item) ? 'active' : '' ?> <?= $block->hasChildren($item) ? 'has-children' : '' ?>">
                
                <?php if (!empty($item['url'])): ?>
                    <a href="<?= $block->escapeHtml($item['url']) ?>">
                        <?php if (isset($item['icon'])): ?>
                            <span class="menu-icon <?= $block->escapeHtml($item['icon']) ?>"></span>
                        <?php endif; ?>
                        <span class="menu-text"><?= $block->escapeHtml($item['title']) ?></span>
                    </a>
                <?php else: ?>
                    <div class="menu-header">
                        <?php if (isset($item['icon'])): ?>
                            <span class="menu-icon <?= $block->escapeHtml($item['icon']) ?>"></span>
                        <?php endif; ?>
                        <span class="menu-text"><?= $block->escapeHtml($item['title']) ?></span>
                        <?php if ($block->hasChildren($item)): ?>
                            <span class="menu-arrow">â–¼</span>
                        <?php endif; ?>
                    </div>
                <?php endif; ?>
                
                <?php if ($block->hasChildren($item)): ?>
                    <ul class="admin-submenu <?= $block->isActive($item) ? 'active' : '' ?>">
                        <?php foreach ($item['children'] as $child): ?>
                            <li class="admin-menu-item <?= $block->isActive($child) ? 'active' : '' ?>">
                                <?php if (!empty($child['url'])): ?>
                                    <a href="<?= $block->escapeHtml($child['url']) ?>">
                                        <?= $block->escapeHtml($child['title']) ?>
                                    </a>
                                <?php else: ?>
                                    <span><?= $block->escapeHtml($child['title']) ?></span>
                                <?php endif; ?>
                            </li>
                        <?php endforeach; ?>
                    </ul>
                <?php endif; ?>
                
            </li>
        <?php endforeach; ?>
    </ul>
</nav>
<!-- MENU DEBUG: END -->
